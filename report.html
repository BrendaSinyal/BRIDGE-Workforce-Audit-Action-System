<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Full Report</title>
</head>
<body style="margin:0">
<div id="err" style="font-family:Arial;padding:16px;color:#b00020"></div>
<div id="mount"></div>

<script>
const WEBAPP_URL = "PASTE_WEBAPP_URL_KAMU";

const params = new URLSearchParams(location.search);
const token = params.get("t");

function jsonp(url, cbName){
  const s=document.createElement("script");
  s.src=url + "&callback=" + cbName;
  s.onerror=()=>document.getElementById("err").textContent="Network error. Refresh.";
  document.body.appendChild(s);
}

(function(){
  if(!token){
    document.getElementById("err").textContent="Missing token. Please use your email link.";
    return;
  }
  const cb="cb_"+Date.now();
  window[cb]=function(res){
    try{delete window[cb];}catch(e){}
    if(!res||!res.ok){
      document.getElementById("err").textContent=(res&&res.error)?res.error:"Not found.";
      return;
    }
    // FULL report (result + action plan)
    document.getElementById("mount").innerHTML = res.reportHtml || "<div style='font-family:Arial;padding:16px'>Missing reportHtml.</div>";
  };
  jsonp(WEBAPP_URL + "?mode=reportByToken&t=" + encodeURIComponent(token), cb);
})();
</script>
</body>
</html>
